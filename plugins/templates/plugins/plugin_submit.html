{% extends 'base.html' %}

{% block title %}Submit Plugin - Cauldron Plugin Registry{% endblock %}

{% block content %}
<div class="row" style="margin-top: 40px;">
    <div class="col s12 m10 offset-m1 l8 offset-l2">
        <h4 style="font-weight: 300; margin-bottom: 20px;">Submit a Plugin</h4>
        <p class="grey-text" style="margin-bottom: 40px;">
            Provide the URL to your plugin's public Git repository.
        </p>

        <form method="post" id="submit-form">
            {% csrf_token %}
            <div class="row">
                <div class="input-field col s12">
                    <i class="material-icons prefix">link</i>
                    <input id="{{ form.repo_url.id_for_label }}" name="{{ form.repo_url.name }}" type="url" class="validate" required>
                    <label for="{{ form.repo_url.id_for_label }}">Git Repository URL</label>
                    {% if form.repo_url.errors %}
                        <span class="helper-text red-text">{{ form.repo_url.errors.as_text }}</span>
                    {% endif %}
                </div>
            </div>
            <div class="row">
                <div class="col s12">
                    <button class="btn-large waves-effect waves-light" type="submit" name="action" id="submit-btn">
                        Submit Plugin
                        <i class="material-icons right">send</i>
                    </button>
                </div>
            </div>
            <div class="row" id="processing-indicator" style="display: none;">
                <div class="col s12">
                    <div class="card blue lighten-5">
                        <div class="card-content">
                            <p class="center-align">
                                <i class="material-icons rotating" style="font-size: 48px; color: #2196F3;">sync</i>
                            </p>
                            <p class="center-align" style="font-size: 18px;">Processing plugin submission...</p>
                            <p class="center-align grey-text">Cloning repository and validating plugin.yaml</p>
                            <div class="progress">
                                <div class="indeterminate"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <style>
            @keyframes rotate {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
            .rotating {
                animation: rotate 2s linear infinite;
            }
        </style>

        <script>
            document.getElementById('submit-form').addEventListener('submit', function(e) {
                const submitBtn = document.getElementById('submit-btn');
                const processingIndicator = document.getElementById('processing-indicator');

                submitBtn.disabled = true;
                submitBtn.innerHTML = 'Processing... <i class="material-icons right">hourglass_empty</i>';
                processingIndicator.style.display = 'block';
            });
        </script>
    </div>
</div>
{% endblock %}